<!DOCTYPE html>
<html>
  <head>
    <title>Kamera auswählen</title>
  </head>
  <body>
    <h2>Kamera auswählen</h2>
    <select id="cameraSelect"></select>
    <button onclick="startCamera()">Start</button>
    <br><br>
    <video id="video" autoplay playsinline width="100%" height="auto"></video>

    <script>
      let currentStream;

      async function getCameras() {
        const devices = await navigator.mediaDevices.enumerateDevices();
        const videoDevices = devices.filter(device => device.kind === 'videoinput');
        const select = document.getElementById('cameraSelect');

        videoDevices.forEach(device => {
          const option = document.createElement('option');
          option.value = device.deviceId;
          option.text = device.label || `Kamera ${select.length + 1}`;
          select.appendChild(option);
        });
      }

      async function startCamera() {
        if (currentStream) {
          currentStream.getTracks().forEach(track => track.stop());
        }

        const deviceId = document.getElementById('cameraSelect').value;
        const constraints = {
          video: {
            deviceId: { exact: deviceId },
            width: { ideal: 1280 },
            height: { ideal: 720 }
          }
        };

        try {
          const stream = await navigator.mediaDevices.getUserMedia(constraints);
          currentStream = stream;
          const videoElement = document.getElementById('video');
          videoElement.srcObject = stream;
        } catch (err) {
          alert('Kamerazugriff fehlgeschlagen: ' + err.message);
        }
      }

      getCameras();
    </script>
  </body>
</html>
